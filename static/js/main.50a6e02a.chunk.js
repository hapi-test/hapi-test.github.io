(this.webpackJsonpmlapi=this.webpackJsonpmlapi||[]).push([[0],{170:function(e,t,n){e.exports=n.p+"static/media/full_banner.3f11d53f.png"},171:function(e,t,n){e.exports=n.p+"static/media/trans_banner.f7a16bfd.png"},184:function(e,t,n){e.exports=n(302)},189:function(e,t,n){},209:function(e,t,n){},210:function(e,t,n){},211:function(e,t,n){},212:function(e,t,n){},213:function(e,t,n){},299:function(e,t,n){},300:function(e,t,n){var a=n(124);!function(){function e(e){return e.length?a.keys(e[0]).sort():[]}function t(e,t){e.stopPropagation(),e.preventDefault()}function n(e){return e.name}function r(e){return e[0].categories.reduce((function(e,t){return e+t.count}),0)}a.parsets=function(){var i,o,f,p,m=a.dispatch("sortDimensions","sortCategories","ribbonClick","categoryClick"),g=e,v=String,y=d,b=h,_=20,E=1,x=500;function k(e,t,n){return function(){var a=n.apply(t,arguments);return a===t?e:a}}function w(e){return"function"===typeof e?e:function(){return e}}function C(e){e.each((function(e,c){var d,h,v,k,w=a.select(this),C=a.scaleOrdinal(),O=!1,L=g.call(this,e,c),T=[],F={children:{},count:0};if(a.select(window).on("mousemove.parsets."+ ++s,J),null==p&&(p=E),w.selectAll(".ribbon, .ribbon-mouse").data(["ribbon","ribbon-mouse"],String).enter().append("g").attr("class",String),function(){var c=w.selectAll("g.dimension"),s={};c.each((function(e){s[e.name]=e})),L.forEach((function(e){s.hasOwnProperty(e)||(s[e]={name:e,categories:[]}),T.push(s[e])})),T.sort(N),w.select(".ribbon").selectAll("path").each((function(e){for(var t=e.path.split("\0"),n=F,a=t.length-1,r=0;r<a;r++){var i=t[r];n=n.children.hasOwnProperty(i)?n.children[i]:n.children[i]={children:{},count:0}}n.children[e.name]=e})),F=l(F,e,T.map(n),i),s=T.map((function(e){var t={};return e.categories.forEach((function(e){t[e.name]=e})),t})),function e(t,n){if(t.children){var a=T[n],r=s[n];for(var i in t.children)r.hasOwnProperty(i)||a.categories.push(r[i]={name:i}),e(t.children[i],n+1)}}(F,0),T.forEach((function(e,t){T[t].categories=e.categories.sort((function(e,t){return e.name<t.name?-1:1}))})),C.domain([]).range(a.range(T[0].categories.length)),d=j(F,T,C),h=r(T),T.forEach((function(e){e.count=h}));var p=(c=c.data(T,n)).enter().append("g").attr("class","dimension").attr("transform",(function(e){return"translate(0,"+e.y+")"})).on("mousedown.parsets",t);c.merge(p).each((function(e){e.y0=e.y,e.categories.forEach((function(e){e.x0=e.x}))})),p.append("rect").attr("width",o).attr("y",-45).attr("height",45);var g=p.append("text").attr("class","dimension").attr("transform","translate(0,-25)");g.append("tspan").attr("class","name").text(I),g.append("tspan").attr("class","sort alpha").attr("dx","2em").text("alpha \xbb").on("mousedown.parsets",t),g.append("tspan").attr("class","sort size").attr("dx","2em").text("size \xbb").on("mousedown.parsets",t),c.merge(p).call(a.drag().on("start",(function(e,t){O=!0,t.y0=t.y})).on("drag",(function(t,o){o.y0=o.y=t.y;for(var s=1;s<T.length;s++)if(f*T[s].y<f*T[s-1].y){T.sort(N),L=T.map(n),C.domain([]).range(a.range(T[0].categories.length)),d=j(F=l({children:{},count:0},e,L,i),T,C),h=r(T),w.selectAll(".ribbon, .ribbon-mouse").selectAll("path").remove(),q(c.merge(p)),z(),c.merge(p).transition().duration(x).attr("transform",u).tween("ribbon",G),m.call("sortDimensions");break}a.select(this).attr("transform","translate(0,"+o.y+")").transition(),v.merge(k).filter((function(e){return e.source.dimension===o||e.target.dimension===o})).attr("d",D)})).on("end",(function(e,t){O=!1,J();var n=(f-45-2)/(T.length-1);T.forEach((function(e,t){e.y=45+t*n})),P(a.select(this)).attr("transform","translate(0,"+t.y+")").tween("ribbon",G)}))),c.merge(p).select("text").select("tspan.sort.alpha").on("click.parsets",H("alpha",(function(e,t){return e.name<t.name?1:-1}),c)),c.merge(p).select("text").select("tspan.sort.size").on("click.parsets",H("size",(function(e,t){return e.count-t.count}),c)),c.merge(p).transition().duration(x).attr("transform",(function(e){return"translate(0,"+e.y+")"})).tween("ribbon",G),c.exit().remove(),q(c.merge(p)),z()}(),E!=p){var R=a.transition(w);R.tween?R.tween("ribbon",W):W()(1)}function W(){var e=a.interpolateNumber(p,E);return function(t){p=e(t),v.merge(k).attr("d",D)}}function H(e,t,n){return function(r,i){var o=this.__direction=-(this.__direction||1);a.select(this).text(o>0?e+" \xbb":"\xab "+e),i.categories.sort((function(){return o*t.apply(this,arguments)})),d=j(F,T,C),z(),q(n.merge(n.enter())),m.call("sortCategories")}}function z(){v=w.select(".ribbon").selectAll("path").data(d,(function(e){return e.path})),(k=v.enter().append("path").each((function(e){e.source.x0=e.source.x,e.target.x0=e.target.x}))).merge(v).attr("class",(function(e){return"category-"+e.major})).attr("d",D),k.merge(v).sort((function(e,t){return t.count-e.count})),v.exit().remove();var e=w.select(".ribbon-mouse").selectAll("path").data(d,(function(e){return e.path})),t=e.enter().append("path");t.merge(e).on("mousemove.parsets",(function(e,t){U(v.merge(k)).classed("active",!1),O||(B(t=t.node,!0),S(y.call(this,t),e),e.stopPropagation())})).on("click.parsets",(function(e,t){v.merge(k).classed("active",!1),v.merge(k).classed("selected",!1),O||(Y(t=t.node,!0),m.call("ribbonClick",this,{data:t,selected:!0}),e.stopPropagation())})),e.merge(t).sort((function(e,t){return t.count-e.count})).attr("d",M),e.exit().remove()}function V(e){var t=[e],n=v.merge(k).filter((function(n){var a,r;return n.source.node===e&&t.push(a=n.source),n.target.node===e&&t.push(r=n.target),a||r})),r=t.map((function(e){return a.interpolateNumber(e.x0,e.x)})),i=t.length;return function(e){for(var a=0;a<i;a++)t[a].x0=r[a](e);n.attr("d",D)}}function G(e){var t=v.merge(k).filter((function(t){return t.source.dimension.name==e.name||t.target.dimension.name==e.name})),n=a.interpolateNumber(e.y0,e.y);return function(a){e.y0=n(a),t.attr("d",D)}}function B(e,t){if(!O){var n=[];if(function e(t){for(var a in n.push(t),t.children)e(t.children[a])}(e),n.shift(),t)for(;e;)n.push(e),e=e.parent;v.merge(k).filter((function(e){var t=n.indexOf(e.node)>=0;return t&&this.parentNode.appendChild(this),t})).classed("active",!0)}}function Y(e,t){if(!O){var n=[];if(function e(t){for(var a in n.push(t),t.children)e(t.children[a])}(e),n.shift(),t)for(;e;)n.push(e),e=e.parent;v.merge(k).filter((function(e){var t=n.indexOf(e.node)>=0;return t&&this.parentNode.appendChild(this),t})).classed("selected",!0).classed("active",!0)}}function U(e){return e.filter((function(e){return!a.select(this).classed("selected")}))}function J(){O||(U(v.merge(k)).classed("active",!1),A.style("display","none"))}function q(e){var n=e.selectAll("g.category").data((function(e){return e.categories}),(function(e){return e.dimension.name+"_"+e.name})),r=n.enter().append("g").attr("class","category");r.merge(n).attr("transform",(function(e){return"translate("+e.x+")"})),n.merge(r).on("mousemove.parsets",(function(e,t){U(v.merge(k)).classed("active",!1),O||(t.nodes.forEach((function(e){B(e)})),S(b.call(this,t),e),e.stopPropagation())})).on("mouseout.parsets",J).on("mousedown.parsets",t).call(a.drag().on("start",(function(e,t){O=!0,t.x0=t.x})).on("drag",(function(t,n){n.x=t.x;for(var r=n.dimension.categories,i=0,c=r[0];++i<r.length;)if(c.x+c.dx/2>(c=r[i]).x+c.dx/2){r.sort((function(e,t){return e.x+e.dx/2-t.x-t.dx/2})),d=j(F,T,C),z(),q(e),B(n.node),m.call("sortCategories");break}var s=0,l=_/(r.length-1);r.forEach((function(e){n===e&&(e.x0=t.x),e.x=s,s+=e.count/h*(o-_)+l})),a.select(this).attr("transform",(function(e){return"translate("+e.x0+")"})).transition(),v.merge(k).filter((function(e){return e.source.node===n||e.target.node===n})).attr("d",D)})).on("end",(function(e,t){O=!1,J(),z(),P(a.select(this)).attr("transform","translate("+t.x+")").tween("ribbon",V)}))).on("click.parsets",(function(e,t){O||(v.merge(k).classed("active",!1),v.merge(k).classed("selected",!1),t.nodes.forEach((function(e){Y(e)})),m.call("categoryClick",this,{data:t,selected:!0}),e.stopPropagation())})),n.merge(r).transition().duration(x).attr("transform",(function(e){return"translate("+e.x+")"})).tween("ribbon",V),r.append("rect").attr("width",(function(e){return e.dx})).attr("y",-20).attr("height",20),r.append("line").style("stroke-width",2),r.append("text").attr("dy","-.3em"),n.merge(r).select("rect").attr("width",(function(e){return e.dx})).attr("class",(function(e){return"category-"+(e.dimension===T[0]?C(e.name):"background")})),n.merge(r).select("line").attr("x2",(function(e){return e.dx})),n.merge(r).select("text").text(function(e,t){return function(n,a){var r=this.textContent=e(n,a),i=t(n,a);if(this.getComputedTextLength()<i)return r;this.textContent="\u2026"+r;for(var o=0,c=r.length+1;o<c;){var s=o+c>>1;this.getSubStringLength(0,s)<i?o=s+1:c=s}return o>1?r.substr(0,o-2)+"\u2026":""}}((function(e){return e.name}),(function(e){return e.dx})))}}))}a.rebind=function(e,t){for(var n,a=1,r=arguments.length;++a<r;)e[n=arguments[a]]=k(e,t,t[n]);return e},C.dimensionFormat=function(e){return arguments.length?(v=e,C):v},C.dimensions=function(e){return arguments.length?(g=w(e),C):g},C.value=function(e){return arguments.length?(i=w(e),C):i},C.width=function(e){return arguments.length?(o=+e,C):o},C.height=function(e){return arguments.length?(f=+e,C):f},C.spacing=function(e){return arguments.length?(_=+e,C):_},C.tension=function(e){return arguments.length?(E=+e,C):E},C.duration=function(e){return arguments.length?(x=+e,C):x},C.tooltip=function(e){return arguments.length?(y=null==e?d:e,C):A},C.categoryTooltip=function(e){return arguments.length?(b=null==e?h:e,C):b};var O=a.select("body"),A=O.append("div").style("display","none").attr("class","parsets tooltip");return a.rebind(C,m,"on").value(1).width(960).height(600);function I(e,t){return v.call(this,e.name,t)}function S(e,t){var n=a.pointer(t,O.node());A.style("display",null).style("left",n[0]+30+"px").style("top",n[1]-20+"px").html(e)}function P(e){return x?e.transition().duration(x).ease(c):e}function j(e,t,n){var a=[],r=t.length,i=(f-45-2)/(r-1);t.forEach((function(e,t){e.categories.forEach((function(t){t.dimension=e,t.count=0,t.nodes=[]})),e.y=45+t*i}));var c=function e(n,a){if(!n.children)return n.count;var r=t[a],i=0;return r.categories.forEach((function(t){var r=n.children[t.name];if(r){t.nodes.push(r);var o=e(r,a+1);t.count+=o,i+=o}})),i}(e,0);return t.forEach((function(e){e.categories=e.categories.filter((function(e){return e.count}));var t=0,n=_/(e.categories.length-1);e.categories.forEach((function(e){e.x=t,e.dx=e.count/c*(o-_),e.in={dx:0},e.out={dx:0},t+=e.dx+n}))})),t[0].categories.forEach((function(r){var i=r.name;e.children.hasOwnProperty(i)&&function e(n,r,i,s){var l=r.node,u=t[i];u.categories.forEach((function(d){var h=d.name;if(l.children.hasOwnProperty(h)){var f=l.children[h];f.path=r.path+"\0"+h;var p=f.target||{node:d,dimension:u};p.x=d.in.dx,p.dx=f.count/c*(o-_),d.in.dx+=p.dx;var m=f.source||{node:n,dimension:t[i-1]};m.x=n.out.dx,m.dx=p.dx,n.out.dx+=m.dx,f.node=f,f.source=m,f.target=p,f.major=s,a.push(f),i+1<t.length&&e(d,f,i+1,s)}}))}(r,{node:e.children[i],path:i},1,n(i))})),a}function D(e){var t=e.source,n=e.target;return L(t.node.x0+t.x0,t.dimension.y0,t.dx,n.node.x0+n.x0,n.dimension.y0,n.dx,p)}function M(e){var t=e.source,n=e.target;return L(t.node.x+t.x,t.dimension.y,t.dx,n.node.x+n.x,n.dimension.y,n.dx,E)}function L(e,t,n,a,r,i,o){var c,s;return(1===o?["M",[e,t],"L",[a,r],"h",i,"L",[e+n,t],"Z"]:["M",[e,t],"C",[e,c=o*t+(1-o)*r]," ",[a,s=o*r+(1-o)*t]," ",[a,r],"h",i,"C",[a+i,s]," ",[e+n,c]," ",[e+n,t],"Z"]).join("")}function N(e,t){return(e=f*e.y)<(t=f*t.y)?-1:e>t?1:e>=t?0:e<=e?-1:t<=t?1:NaN}},a.parsets.tree=l;var i=a.format(".2%"),o=a.format("d"),c=a.easeElastic,s=0;function l(e,t,n,a){!function e(t){if(t.count=0,t.children)for(var n in t.children)e(t.children[n])}(e);for(var r=t.length,i=n.length,o=0;o<r;o++){for(var c=t[o],s=+a(c,o),l=e,u=0;u<i;u++){var d=n[u],h=c[d],f=l.children;l.count+=s,l=f.hasOwnProperty(h)?f[h]:f[h]={children:u===i-1?null:{},count:0,parent:l,dimension:d,name:h}}l.count+=s}return e}function u(e){return"translate(0,"+e.y+")"}function d(e){for(var t=e.count,n=[];e.parent;)e.name&&n.unshift(e.name),e=e.parent;return n.join(" \u2192 ")+"<br>"+o(t)+" ("+i(t/e.count)+")"}function h(e){return e.name+"<br>"+o(e.count)+" ("+i(e.count/e.dimension.count)+")"}}()},302:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),i=n(23),o=n.n(i);n(189),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var c=n(40),s=n(173),l=n(29),u=n(10),d=n.n(u),h=n(53),f=n(126),p=n.n(f),m=window.location.origin,g=(p.a.create({baseURL:"".concat(m,"/api/"),headers:{"Access-Control-Allow-Origin":"*"}}),window.location.href),v=p.a.create({baseURL:"".concat(g,"/data/"),headers:{"Access-Control-Allow-Origin":"*"}});function y(){return b.apply(this,arguments)}function b(){return(b=Object(h.a)(d.a.mark((function e(){var t,n,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="/data",t="/data.json",n={},e.next=5,v.get(t,{params:n});case 5:if(200!==(a=e.sent).status){e.next=8;break}return e.abrupt("return",a.data);case 8:throw a;case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(){return E.apply(this,arguments)}function E(){return(E=Object(h.a)(d.a.mark((function e(){var t,n,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="/explore",t="/explore.json",n={},e.next=5,v.get(t,{params:n});case 5:if(200!==(a=e.sent).status){e.next=8;break}return e.abrupt("return",a.data);case 8:throw a;case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(){return k.apply(this,arguments)}function k(){return(k=Object(h.a)(d.a.mark((function e(){var t,n,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="/datasets",t="/datasetlist.json",n={},e.next=5,v.get(t,{params:n});case 5:if(200!==(a=e.sent).status){e.next=8;break}return e.abrupt("return",a.data);case 8:throw a;case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"PASCAL",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"2008_000348.jpg";"".concat(m,"/api/");return"".concat(g,"/data/")+"/"+e+"/"+t}var C={dataset_id:1,api_id:null,api_id_list:[1],datasetList:[],user_verify:!0,data:{},explore_meta_data:{},task_id:2,mode_id:2,view_mode:1},O=(n(209),n(210),n(15)),A=n(16),I=n(22),S=n(26),P=n(27),j=n(312),D=n(317),M=n(318),L=n(319),N=n(320),T=n(321),F=n(178),R=n(322),W=n(323),H=(n(211),n(212),n(213),n(93)),z=n(316),V=n(311),G=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],B=(G.concat(["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec"]).concat(["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"]).concat(["#1A7AB1","#ADC8E6","#FF772D","#FFB87F","#2AA13A","#98E090","#FF9398","#9467B9","#C5B0D3","#C49B95","#E474C0","#F7B4D1","#BCBC3D","#07C1CD"]),["#313695","#4575b4","#74add1","#abd9e9","#e0f3f8","#ffffbf","#fee090","#fdae61","#f46d43","#d73027","#a50026"]),Y=function(){return B},U=function(e){var t=e;t<0&&(t=0),t>1&&(t=1);var n=Y();return J(n,t)},J=function(e,t){var n=e.length,a=1/(n-1),r=Math.floor(t/a);r==n-1&&(r-=1);var i=(t-r*a)/a;return q(e[r],e[r+1],i)},q=function(e,t,n){var a=function(e){if((e=e.toLowerCase())&&/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/.test(e)){if(4===e.length){for(var t="#",n=1;n<4;n+=1)t+=e.slice(n,n+1).concat(e.slice(n,n+1));e=t}var a=[];for(n=1;n<7;n+=2)a.push(parseInt("0x"+e.slice(n,n+2)));return a}return e};e=e.replace(/\s+/g,""),t=t.replace(/\s+/g,"");var r=a(e),i=r[0],o=r[1],c=r[2],s=a(t),l=s[0],u=s[1],d=s[2];n>1?(console.log("out of range step: ",n),n=1):n<0&&(console.log("out of range step: ",n),n=0);var h=(u-o)*n,f=(d-c)*n,p=parseInt((l-i)*n+i),m=parseInt(h+o),g=parseInt(f+c),v="#",y=new Array;y[0]=p,y[1]=m,y[2]=g;for(var b=0;b<3;b++){var _=Number(y[b]).toString(16),E=Number(y[b])<16?"0"+_:_;"0"===E&&(E+=E),v+=E}return v};function K(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=!0,i=Object.keys(e),o=0;o<t.length;o++)if(i.indexOf(t[o])>=0);else if(r=!1,n){var c=t[o]+" is required.";a&&(c=t[o]+" is required in "+a+" ."),console.log(c)}return r}function X(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=t.filter((function(e){return Object.keys(e).indexOf("n")>=0})),i=r.map((function(e){return e.n})),o=K(e,i,n,a);if(o){for(var c=!0,s=0;s<r.length;s++){var l=r[s].n;if(Object.keys(r[s]).indexOf("c")>=0){var u=r[s].c,d=X(e[l],u,n,a+"."+l);d||(c=!1)}}return c}return!1}var Z,$=["Metrics","Explore"];function Q(){return $}function ee(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=n;if(e){var r=e-1;r>=0&&r<t.length&&(a=t[r])}return a}function te(e,t){for(var n=0;n<t.length;n++){var a=t[n].start,r=t[n].end;if(e>=a&&e<=r)return t[n].name}return""+e}!function(e){e[e.FULL=1]="FULL",e[e.EXCLUEDE_INSTANCE_VIEW=2]="EXCLUEDE_INSTANCE_VIEW"}(Z||(Z={}));Z.FULL;var ne=n(315);function ae(e){return K(e,["TaskNames"])?e.TaskNames:[]}function re(e,t){if(t){var n=ae(e),a=t-1;if(a>=0&&a<n.length){var r=n[a];if(Object.keys(e).indexOf(r)>=0)return{success:!0,task_name:r}}}return{success:!1}}function ie(e,t){var n=re(e,t);if(n.success){var a=e[n.task_name];if(K(a,["DatasetNames"]))return a.DatasetNames}return[]}function oe(e,t){var n=re(e,t);if(n.success){var a=e[n.task_name];if(K(a,["APINames"]))return a.APINames}return[]}function ce(e,t,n,a){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-1,i=K(e,[t]);if(i){var o=e[t],c=o.filter((function(e){return!!K(e,["Year","value","API","Dataset"])&&(e.API==a&&e.Dataset==n)})),s=c.sort((function(e,t){return e.Year<t.Year})),l=s.map((function(e){return e.Year})),u=s.map((function(e){return r>=1?parseFloat(e.value.toFixed(r)):e.value})),d={year:l,value:u};return d}return{}}function se(e){if(!K(e,["year","value"]))return{};for(var t=e.year,n=e.value,a=[],r=[],i=0;i<t.length;i++){var o=t[i],c=n[i],s=o.split("->");2==s.length&&(s.forEach((function(e){a.indexOf(e)>=0||a.push(e)})),r.push({source:s[0],target:s[1],value:c.toFixed(2),label:{show:!0,formatter:function(e){return e.value}},lineStyle:{width:6,color:U(c)}}))}a.sort((function(e,t){return e<t}));var l=[],u=a.length;if(a.length<=0)return{};for(var d=-90,h=360/u,f=0;f<u;f++){var p=10*Math.cos(d/180*Math.PI),m=10*Math.sin(d/180*Math.PI);l.push({name:a[f],x:p,y:m,itemStyle:{color:"#5470C6"}}),d+=h}return{nodes:l,links:r}}function le(e){var t=new Set(e);return Array.from(t)}function ue(e,t){var n=t.PSData.slice(),a=[],r=Object.keys(e);return n.forEach((function(t,n){if(function(t){if(r.length>0){for(var n=0;n<r.length;n++)if(e[r[n]].indexOf(t[r[n]])<0)return!1;return!0}return!0}(t)){var i=t;a.push(i)}})),a}function de(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,a=100*e;a<0&&(a=0),a>100&&(a=100);var i="#0f8CFF";return r.a.createElement(ne.a,{percent:a,size:"small",format:function(){return t+" ("+e.toFixed(n)+")"},style:{width:"30%"},strokeColor:{"0%":i,"100%":i}})}var he=H.a.Option,fe=function(e){Object(S.a)(n,e);var t=Object(P.a)(n);function n(e){var a;return Object(O.a)(this,n),(a=t.call(this,e)).onDatasetSelectorChange=a.onDatasetSelectorChange.bind(Object(I.a)(a)),a.onAPISelectorChange=a.onAPISelectorChange.bind(Object(I.a)(a)),a.onAPIListSelectorChange=a.onAPIListSelectorChange.bind(Object(I.a)(a)),a.onTaskSelectorChange=a.onTaskSelectorChange.bind(Object(I.a)(a)),a.onModeSelectorChange=a.onModeSelectorChange.bind(Object(I.a)(a)),a.state={selectState:!1},a}return Object(A.a)(n,[{key:"componentDidMount",value:function(){this.initData(),this.initExploreMetaData()}},{key:"initExploreMetaData",value:function(){var e=Object(h.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_();case 2:!0===(t=e.sent).success&&X(t,[{n:"data",c:[{n:"DatasetNames"}]}],!0,"data_package")&&(console.log("explore meta package",t),this.props.initExploreMetaData(t.data));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initData",value:function(){var e=Object(h.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y();case 2:!0===(t=e.sent).success&&X(t,[{n:"data",c:[{n:"TaskNames"}]}],!0,"data_package")&&(console.log("data package",t),this.props.initData(t.data));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initDatasetList",value:function(){var e=Object(h.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x();case 2:!0===(t=e.sent).success&&X(t,[{n:"datasets",c:[{n:"DatasetsList"}]}],!0,"datasetList_package")&&this.props.initDatasetList(t.datasets.DatasetsList);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onTaskSelectorChange",value:function(e){this.props.changeTask(e),this.props.clearIdInfo()}},{key:"onDatasetSelectorChange",value:function(e){this.props.changeDataset(e)}},{key:"onAPISelectorChange",value:function(e){this.props.changeAPI(e)}},{key:"onAPIListSelectorChange",value:function(e){this.props.changeAPIList(e)}},{key:"onModeSelectorChange",value:function(e){this.props.changeMode(e)}},{key:"render",value:function(){var e=this;console.log("api_id_list",this.props.api_id_list);var t=this.props,n=t.data,r=t.task_id,i=t.dataset_id,o=t.explore_meta_data,c=ae(n),s=ie(n,r),l=oe(n,r),u=Q(),d=l.length<=0,h=s.length<=0,f=c.length<=0,p=(u.length,!1),m=function(e){return K(e,["DatasetNames"])?e.DatasetNames:[]}(o),g=ee(i,s);m.indexOf(g)>=0&&(p=!0),console.log("visible",p,m,g);var v,y,b=l.map((function(e,t){return t+1})),_=(v=new Set(b),y=new Set(this.props.api_id_list),v.size===y.size&&Array.from(v).every((function(e){return y.has(e)}))),E=function(t){return a.createElement(L.a,{span:t},a.createElement(M.a,null,"Task:\xa0"),a.createElement(M.a,null,a.createElement(H.a,{placeholder:"Select a Task",value:e.props.task_id||void 0,style:{width:"95%"},onChange:e.onTaskSelectorChange,disabled:f},c.map((function(e,t){return a.createElement(he,{value:t+1,key:t+1},e)})))))},x=function(t){return a.createElement(L.a,{span:t},a.createElement(M.a,null,"API:\xa0"),a.createElement(M.a,null,a.createElement(H.a,{mode:"multiple",allowClear:!0,placeholder:"Select APIs",value:e.props.api_id_list,style:{width:"95%"},onChange:e.onAPIListSelectorChange,disabled:d,dropdownRender:function(t){return a.createElement("div",null,a.createElement("div",{style:{padding:"4px 8px 8px 8px",cursor:"pointer"}},a.createElement(z.a,{checked:_,onChange:function(t){!0===t.target.checked?e.onAPIListSelectorChange(b):e.onAPIListSelectorChange([])}},"All")),a.createElement(V.a,{style:{margin:"0"}}),t)}},l.map((function(e,t){return a.createElement(he,{value:t+1,key:t+1},e)})))))},k=function(t){return a.createElement(L.a,{span:t},a.createElement(M.a,null,"Dataset:\xa0"),a.createElement(M.a,null,a.createElement(H.a,{placeholder:"Select a dataset",value:e.props.dataset_id||void 0,style:{width:"95%"},onChange:e.onDatasetSelectorChange,disabled:h},s.map((function(e,t){return a.createElement(he,{value:t+1,key:t+1},e)})))))};return this.props.width>=620?(console.log("horizontal width:",this.props.width),a.createElement(M.a,null,E(8),x(8),k(8))):a.createElement(M.a,null,a.createElement(L.a,{span:24},a.createElement(M.a,null,E(24)),a.createElement(M.a,null,x(24)),a.createElement(M.a,null,k(24))))}}]),n}(a.Component),pe=function(e){return{type:"MODE_ID_CHANGE",mode_id:e}},me=Object(c.b)((function(e){return{dataset_id:e.dataset_id,datasetList:e.datasetList,data:e.data,explore_meta_data:e.explore_meta_data,api_id:e.api_id,api_id_list:e.api_id_list,mode_id:e.mode_id,task_id:e.task_id}}),(function(e){return{changeTask:function(t){return e(function(e){return{type:"TASK_ID_CHANGE",task_id:e}}(t))},changeAPI:function(t){return e(function(e){return{type:"API_ID_CHANGE",api_id:e}}(t))},changeMode:function(t){return e(pe(t))},changeAPIList:function(t){return e(function(e){return{type:"API_ID_LIST_CHANGE",api_id_list:e}}(t))},changeDataset:function(t){return e(function(e){return{type:"DATASET_ID_CHANGE",dataset_id:e}}(t))},clearIdInfo:function(){return e({type:"CLEAR_ID_INFO"})},initData:function(t){return e(function(e){return{type:"INIT_DATA",data:e}}(t))},initExploreMetaData:function(t){return e(function(e){return{type:"INIT_EXPLORE_META_DATA",explore_meta_data:e}}(t))},initDatasetList:function(t){return e(function(e){return{type:"INIT_DATASET_LIST",datasetList:e}}(t))}}}))(fe),ge=function(e){Object(S.a)(n,e);var t=Object(P.a)(n);function n(e){var a;return Object(O.a)(this,n),(a=t.call(this,e)).state={},a}return Object(A.a)(n,[{key:"render",value:function(){var e=!1;return e=!0,console.log(e,this.props.user_verify,!1),a.createElement("div",null,a.createElement("div",{className:"ViewTitle2"},"Control Panel"),a.createElement("div",{className:"ViewBox"},e?a.createElement(me,{width:this.props.width}):a.createElement("div",null)))}}]),n}(a.Component),ve=Object(c.b)((function(e){return{dataset_id:e.dataset_id,user_verify:e.user_verify}}),(function(e){return{}}))(ge),ye=(n(167),n(41)),be=n(59),_e=function(e){Object(S.a)(n,e);var t=Object(P.a)(n);function n(e){var r;return Object(O.a)(this,n),(r=t.call(this,e)).refresh_number=1,r.renderAccuracyChart=function(e){var t=Object.keys(e),n=[],i=[],o=1,c=0,s=!0;r.refresh_number=r.refresh_number+1;for(var l=0;l<t.length;l++){var u=t[l],d=e[u];if(!K(d,["year","value"])){s=!1;break}0==l&&(n=d.year);var h=Math.min.apply(Math,Object(ye.a)(d.value)),f=Math.max.apply(Math,Object(ye.a)(d.value));o=Math.min(h,o),c=Math.max(f,c);var p={data:d.value,type:"line",name:u};i.push(p)}console.log("y_series_data",i),(c=Math.floor(100*(parseFloat(c.toFixed(2))+.01))/100)<(o=Math.floor(100*(parseFloat(o.toFixed(2))-.01))/100)&&(c=o);var m={};return s?(m={title:{},tooltip:{formatter:function(e){return e.marker+e.name+"&nbsp;&nbsp;&nbsp;&nbsp;<strong>"+e.data.toFixed(3)+"</strong>"}},grid:{left:"50",right:"50"},legend:{right:"50"},xAxis:{type:"category",boundaryGap:!1,data:n},yAxis:{type:"value",min:o,max:c},series:i,notMerge:!0},a.createElement(be.a,{key:r.refresh_number,option:m})):a.createElement("div",null)},r.renderAccuracyChart_SinglePackage=function(e){var t={};if(K(e,["year","value"])){var n=Math.min.apply(Math,Object(ye.a)(e.value)),r=Math.max.apply(Math,Object(ye.a)(e.value));return(r=parseFloat(r.toFixed(2))+.01)<(n=parseFloat(n.toFixed(2))-.01)&&(r=n),t={title:{text:"Accuracy"},tooltip:{},xAxis:{type:"category",boundaryGap:!1,data:e.year},yAxis:{type:"value",min:n,max:r},series:[{data:e.value,type:"line"}]},a.createElement(be.a,{option:t})}return a.createElement("div",null)},r.renderAccuracyChart=r.renderAccuracyChart.bind(Object(I.a)(r)),r.state={},r}return Object(A.a)(n,[{key:"render",value:function(){return this.renderAccuracyChart(this.props.acc_package)}}]),n}(a.Component),Ee=function(e){Object(S.a)(n,e);var t=Object(P.a)(n);function n(e){var r;return Object(O.a)(this,n),(r=t.call(this,e)).renderConsistencyChart=function(e){var t=K(e,["nodes","links"]);console.log(e);var n={};return t?(n={title:{},tooltip:{},animationDurationUpdate:1500,animationEasingUpdate:"quinticInOut",visualMap:{min:0,max:1,type:"continuous",calculable:!1,text:["1","0"],precision:2,inRange:{color:Y()}},series:[{type:"graph",layout:"none",symbolSize:50,roam:!0,label:{show:!0},edgeSymbol:["circle"],edgeSymbolSize:[4,10],edgeLabel:{fontSize:20},data:e.nodes,links:e.links,lineStyle:{opacity:1,width:5,curveness:0}}]},a.createElement(be.a,{option:n})):a.createElement("div",null)},r.renderConsistencyChart=r.renderConsistencyChart.bind(Object(I.a)(r)),r.state={},r}return Object(A.a)(n,[{key:"render",value:function(){return this.renderConsistencyChart(this.props.consistency_package)}}]),n}(a.Component),xe=function(e){Object(S.a)(n,e);var t=Object(P.a)(n);function n(e){var r;return Object(O.a)(this,n),(r=t.call(this,e)).renderConfidenceChart=function(e){var t={};return K(e,["nodes","links"])?(t={title:{},tooltip:{},animationDurationUpdate:1500,animationEasingUpdate:"quinticInOut",visualMap:{min:0,max:1,type:"continuous",calculable:!1,text:["1","0"],precision:2,inRange:{color:Y()}},series:[{type:"graph",layout:"none",symbolSize:50,roam:!0,label:{show:!0},edgeSymbol:["circle"],edgeSymbolSize:[4,10],edgeLabel:{fontSize:20},data:e.nodes,links:e.links,lineStyle:{opacity:.9,width:2,curveness:0}}]},a.createElement(be.a,{option:t})):a.createElement("div",null)},r.renderConfidenceChart=r.renderConfidenceChart.bind(Object(I.a)(r)),r.state={},r}return Object(A.a)(n,[{key:"render",value:function(){return this.renderConfidenceChart(this.props.confidence_package)}}]),n}(a.Component),ke=function(e){Object(S.a)(n,e);var t=Object(P.a)(n);function n(e){var r;return Object(O.a)(this,n),(r=t.call(this,e)).refresh_number=1,r.renderFairnessChart=function(e){var t=K(e,["x_axis_data","y_series_data"]),n={};r.refresh_number=r.refresh_number+1;var i=function(e){return e.marker+e.seriesName+"&nbsp;&nbsp;&nbsp;&nbsp;<strong>"+e.data.toFixed(3)+"</strong>"};return t?(n={title:{},tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:function(e){console.log("tooltip",e);for(var t=e[0].name+"<br />",n=0;n<e.length;n++){var a=e[n];t+=i(a)+"<br />"}return t}},legend:{right:20},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},yAxis:{type:"value",boundaryGap:[0,.01]},xAxis:{type:"category",data:e.x_axis_data},series:e.y_series_data},a.createElement(be.a,{key:r.refresh_number,option:n})):a.createElement("div",null)},r.renderFairnessChart=r.renderFairnessChart.bind(Object(I.a)(r)),r.state={},r}return Object(A.a)(n,[{key:"render",value:function(){return this.renderFairnessChart(this.props.fairness_package)}}]),n}(a.Component),we=(n(299),n(124)),Ce=(n(300),function(e){Object(S.a)(n,e);var t=Object(P.a)(n);function n(e){var a;return Object(O.a)(this,n),(a=t.call(this,e)).onRibbonClick=a.onRibbonClick.bind(Object(I.a)(a)),a.clearFilter=a.clearFilter.bind(Object(I.a)(a)),a.onCategoryClick=a.onCategoryClick.bind(Object(I.a)(a)),a.state={},a}return Object(A.a)(n,[{key:"componentDidMount",value:function(){this.renderD3()}},{key:"componentWillMount",value:function(){}},{key:"shouldComponentUpdate",value:function(e,t){return!0}},{key:"componentWillUpdate",value:function(e,t){}},{key:"componentDidUpdate",value:function(e,t){e.PSJson.name===this.props.PSJson.name&&this.comparePSDimensions(e.PSDimensions,this.props.PSDimensions)&&e.width===this.props.width&&e.height===this.props.height||(we.selectAll("#ParallelSets_SVG").remove(),this.props.changeFilters({}),this.renderD3())}},{key:"comparePSDimensions",value:function(e,t){if(e.length!==t.length)return 0;for(var n=1,a=0;a<e.length;a++)if(e[a]!==t[a]){n=0;break}return n}},{key:"onRibbonClick",value:function(e,t){for(var n={},a=e.data;a&&a.hasOwnProperty("parent");)n[t[a.dimension]]=[a.name],a=a.parent;this.props.changeFilters(n)}},{key:"onCategoryClick",value:function(e,t){console.log("onCategoryClick",e);var n={},a=e.data;n[t[a.dimension.name]]=[a.name],this.props.changeFilters(n)}},{key:"clearFilter",value:function(){console.log("clearFilter"),this.props.changeFilters({})}},{key:"renderD3",value:function(){var e=this,t=this.props,n=t.width,a=t.height,r=t.PSJson,i=t.PSDimensions,o=t.ReversedDimMapping,c=r.PSData,s=i;if(s.length<=1)console.log("The number of dimensions must be larger or equal to 2.");else{var l=we.parsets().dimensions(s).width(n).height(a).tension(1).on("ribbonClick",(function(t){e.onRibbonClick(t,o)})).on("sortDimensions",this.clearFilter).on("sortCategories",this.clearFilter).on("categoryClick",(function(t){e.onCategoryClick(t,o)})),u=c;we.select("#parallelSets").append("svg").attr("id","ParallelSets_SVG").attr("width",l.width()).attr("height",l.height()).datum(u).call(l)}}},{key:"render",value:function(){return a.createElement("div",{id:"parallelSets"})}}]),n}(a.Component)),Oe=n(314),Ae=function(e){Object(S.a)(n,e);var t=Object(P.a)(n);function n(e){var r;return Object(O.a)(this,n),(r=t.call(this,e)).refresh_number=1,r.renderImageDisplay=function(){for(var e=r.props,t=e.image_width,n=e.image_height,i=e.row_image_num,o=r.props.rawdata_list,c=Math.floor(24/i),s=[],u=0;u<o.length;u++){var d=Object(l.a)(Object(l.a)({},o[u]),{},{width:t,height:n,col_size:c});s.push(d)}console.log("new rawdata list",s);var h=s.length,f=Math.ceil(h/i),p=r.state.current_page;if(0==f)return a.createElement("div",null);r.state.current_page>f&&(r.setState({current_page:f}),p=f),r.state.current_page<1&&(r.setState({current_page:1}),p=1),console.log("total page",f,"current page",p);var m=function(e){return K(e,["src","alt","width","height","text_list","col_size"])?a.createElement(L.a,{span:e.col_size,key:e.alt},a.createElement(M.a,null,function(e){return"Image Tagging"==r.props.task_name?a.createElement("img",{src:e.src,alt:e.alt,width:e.width,height:e.height}):a.createElement("audio",{controls:!0,style:{display:"block",transform:"scale(0.9, 1)",transformOrigin:"left"}},a.createElement("source",{src:e.src,type:"audio/wav"}),"Not supported!")}(e)),e.text_list.map((function(e){return a.createElement(M.a,null,e)}))):a.createElement("div",null)};return a.createElement(L.a,{span:24},a.createElement(M.a,null,function(e,t,n){var r=(e-1)*t;r<0&&(r=0);var i=r+t;i>=n.length&&(i=n.length),i<r&&(i=r);var o=n.slice(r,i);return 0==o.length?a.createElement("div",null):o.map((function(e){return m(e)}))}(p,i,s)),a.createElement("br",null),a.createElement(M.a,{justify:"center",align:"middle"},a.createElement(L.a,null,a.createElement(Oe.a,{current:p,total:f,pageSize:1,onChange:r.onPageChange}))))},r.onPageChange=r.onPageChange.bind(Object(I.a)(r)),r.renderImageDisplay=r.renderImageDisplay.bind(Object(I.a)(r)),r.state={current_page:1},r}return Object(A.a)(n,[{key:"onPageChange",value:function(e){this.setState({current_page:e})}},{key:"render",value:function(){return this.renderImageDisplay()}}]),n}(a.Component),Ie=n(124);console.log("d3:",Ie.version);var Se=function(e){Object(S.a)(n,e);var t=Object(P.a)(n);function n(e){var a;return Object(O.a)(this,n),(a=t.call(this,e)).renderInfoContent=a.renderInfoContent.bind(Object(I.a)(a)),a.changeFilters=a.changeFilters.bind(Object(I.a)(a)),a.state={filters:{}},a}return Object(A.a)(n,[{key:"changeFilters",value:function(e){this.setState({filters:e})}},{key:"renderInfoContent",value:function(){var e=this,t=this.props,n=t.dataset_id,r=(t.api_id,t.data),i=t.task_id,o=t.api_id_list,c=t.mode_id,s=ae(r),l=ie(r,i),u=oe(r,i),d=Q(),h=ee(i,s),f=ee(n,l),p=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=n;return e&&e.forEach((function(e){var n=ee(e,t);n?a.push(n):console.log("WARNING: some data are not found.",e)})),a}(o,u),m=ee(c,d);if(p&&f&&h){if("Metrics"==m)return function(){var t={};if(Object.keys(r).indexOf(h)>=0&&(t=r[h]),p.length>1){for(var n={},i=0;i<p.length;i++){var o=p[i],c=ce(t,"AccuracyTable",f,o);n[o]=c}return a.createElement("div",null,a.createElement("div",{style:{width:"100%",height:"100%"}},a.createElement(M.a,null,a.createElement(L.a,{span:24},a.createElement(V.a,null,"Accuracy"),a.createElement(_e,{acc_package:n})))))}if(1===p.length){var s=p[0],l=ce(t,"AccuracyTable",f,s),u={};u[s]=l;var d=ce(t,"ConsistencyTable",f,s),m=ce(t,"ConfidenceTable",f,s),g=se(d),v=se(m),y=function(e,t,n,a){if(K(e,[t])){for(var r=e[t].filter((function(e){return!!K(e,["Year","value","API","Dataset","Subgroup"])&&(e.API==a&&e.Dataset==n)})),i=Array.from(new Set(r.map((function(e){return e.Subgroup})))),o=Array.from(new Set(r.map((function(e){return e.Year})))).sort((function(e,t){return e<t})),c={},s=0;s<r.length;s++){var l=r[s],u=""+l.Year,d=l.Subgroup,h=i.indexOf(d);if(h<0||h>=i.length)console.log("Not found subgroup. ",d);else{if(Object.keys(c).indexOf(u)<0){c[u]=[];for(var f=0;f<i.length;f++)c[u].push(0)}c[u][h]=l.value}}for(var p=i,m=[],g=0;g<o.length;g++){var v=o[g],y={name:v,type:"bar",data:c[v]};m.push(y)}var b={x_axis_data:p,y_series_data:m};return 0==p.length||0==m.length?{}:b}return{}}(t,"FairnessTable",f,s);console.log("fairness_pkg",y);var b=Object.keys(y).length>0;b&&6;var _=function(){return a.createElement(M.a,null,a.createElement(L.a,{span:24},a.createElement(M.a,null,a.createElement(L.a,{span:24},a.createElement(V.a,null,"Accuracy"),a.createElement(_e,{acc_package:u}))),a.createElement(M.a,null,a.createElement(L.a,{span:24},a.createElement(V.a,null,"Consistency"),a.createElement(Ee,{consistency_package:g}))),a.createElement(M.a,null,a.createElement(L.a,{span:24},a.createElement(V.a,null,"Confidence"),a.createElement(xe,{confidence_package:v}))),b?function(e){return a.createElement(M.a,null,a.createElement(L.a,{span:24},a.createElement(V.a,null,"Fairness"),a.createElement(ke,{fairness_package:e})))}(y):a.createElement("div",null)))};return a.createElement("div",null,a.createElement("div",{style:{width:"100%",height:"100%"}},(e.props.width,_())))}}();if("Explore"==m)return function(){if(1===p.length){var t=p[0],n=function(e,t,n,a){if(K(e,[t])){for(var r="PS_"+n+"_"+t,i=e[t],o=Object.keys(i),c=o.map((function(e,t){return{dim:t,name:e}})),s=[],l={},u=[],d=0;d<o.length;d++){var h=o[d];if(K(i,[h]))for(var f=0;f<i[h].length;f++){var p=i[h][f];if(X(p,[{n:"selected_id"},{n:n,c:[{n:"Confidence"},{n:"TrueLabel"},{n:"ImageName"},{n:"OriginalPredictedLabel"}]}])){var m=p.selected_id,g=p[n].Confidence,v=[],y="";if("Image Tagging"==a)y=le(p[n].TrueLabel.map((function(e){return K(e,["transcription"])?e.transcription:""}))).join(", "),v=p[n].OriginalPredictedLabel.filter((function(e){return!!K(e,["transcription","confidence"])})).sort((function(e,t){return t.confidence-e.confidence}));else y=p[n].TrueLabel,v=[{transcription:p[n].OriginalPredictedLabel,confidence:parseFloat(g)}];var b={selected_id:m,confidence:g,year:h,image_name:p[n].ImageName,true_label:y,predicted_label_list:v};u.push(b)}}}u.forEach((function(e){l[e.selected_id]={}})),u.forEach((function(e){l[e.selected_id][e.year]=parseFloat(e.confidence),l[e.selected_id].others=e,l[e.selected_id]["others_"+e.year]=e}));for(var _=Object.keys(l),E=0;E<_.length;E++){var x=_[E],k=l[x],w={};if(K(k,o)){w.image_name=k.others.image_name,w.true_label=k.others.true_label;for(var C=0;C<o.length;C++){var O=o[C];w[O]=k[O],w["Number_"+O]=k[O],w["predicted_label_list_"+O]=k["others_"+O].predicted_label_list}s.push(w)}}for(var A=[],I=[],S=0;S<o.length;S++)A.push([]),I.push([]);for(var P=0;P<s.length;P++)for(var j=s[P],D=0;D<o.length;D++){var M=o[D];A[D].push(j[M])}for(var L=[{start:0,end:.2,name:"[0,0.2]"},{start:.2,end:.4,name:"[0.2,0.4]"},{start:.4,end:.6,name:"[0.4,0.6]"},{start:.6,end:.8,name:"[0.6,0.8]"},{start:.8,end:1,name:"[0.8,1]"}],N=0;N<A.length;N++)I[N]=L;var T={},F={};o.forEach((function(e,t){var n=e+" Average Confidence: "+function(e){if(e.length>0){var t=0;return e.forEach((function(e){t+=e})),t/e.length}return 0}(A[t]).toFixed(2);T[e]=n,F[n]=e}));for(var R=function(e){return T[e]},W=0;W<s.length;W++)for(var H=s[W],z=0;z<o.length;z++){var V=o[z],G=R(V);H[V]=te(H[V],I[z]),H[G]=H[V]}var B=o.map((function(e){return R(e)}));return console.log("series_data",s,A,I),c.length>0&&s.length>0?{PSDimensions:B,ReversedDimMapping:F,PSJson:{PSData:s,name:r}}:{}}return{}}(e.props.explore_meta_data,f,t,h);if(!X(n,[{n:"PSJson",c:[{n:"PSData"},{n:"name"}]},{n:"PSDimensions"},{n:"ReversedDimMapping"}]))return a.createElement("div",null,"Data unavailable.");var r,i=n.PSJson,o=n.PSDimensions,c=n.ReversedDimMapping,s=4,l=200,u=e.props.width-40;s=Math.min(Math.floor(u/l),s),s=Math.max(s,1),l=Math.min(u/s-10,l),r=l=Math.max(l,10);var d=400;d=Math.min(e.props.height-40,d),d=Math.max(d,40);var m=e.props.width-60;m=Math.max(m,40);var g=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=2,r=[{n:"PSJson",c:[{n:"PSData"},{n:"name"}]},{n:"PSDimensions"},{n:"ReversedDimMapping"}],i=X(e,r);if(!i)return[];var o=e.PSJson.PSData;o=ue(n,e.PSJson);var c=e.PSDimensions,s=e.ReversedDimMapping,l=c.map((function(e){return s[e]})),u=[];console.log("PSData, ",o);for(var d=0;d<o.length;d++){var h=o[d],f=[];f.push("Ground Truth: "+h.true_label);for(var p=0;p<l.length;p++){var m=l[p],g=parseFloat(h["Number_"+m]).toFixed(a);f.push(m+" Confidence: "+g),f.push(m+" Predicted Label:");for(var v=0;v<h["predicted_label_list_"+m].length;v++){var y=h["predicted_label_list_"+m][v];f.push(de(y.confidence,y.transcription,a))}}var b=h.image_name,_=w(t,h.image_name);u.push({src:_,alt:b,text_list:f})}return u}(n,f,e.state.filters);return a.createElement("div",{style:{width:"100%",height:"100%"}},a.createElement(M.a,null,a.createElement(L.a,{span:24},a.createElement(V.a,null,"Confidence Parallel Sets"),a.createElement(Ce,{PSJson:i,PSDimensions:o,ReversedDimMapping:c,width:m,height:d,changeFilters:e.changeFilters}),a.createElement(V.a,null,"Instances"),a.createElement(Ae,{rawdata_list:g,image_width:l,image_height:r,row_image_num:s,task_name:h}))))}return a.createElement("div",null,"Please select one API.")}()}return a.createElement("div",null)}},{key:"render",value:function(){console.log("InfoView Props:",this.props);var e=this.props,t=(e.dataset_id,e.api_id,e.data,"Statistics");return 2===e.mode_id&&(t="Explore"),a.createElement("div",null,a.createElement("div",{className:"ViewTitle2"},t),a.createElement("div",{className:"ViewBox"},a.createElement("div",{style:{width:"100%",overflowY:"hidden"}},this.renderInfoContent())))}}]),n}(a.Component),Pe=Object(c.b)((function(e){return{data:e.data,api_id:e.api_id,api_id_list:e.api_id_list,dataset_id:e.dataset_id,task_id:e.task_id,mode_id:e.mode_id,explore_meta_data:e.explore_meta_data}}),(function(e){return{}}))(Se),je=n(313),De=je.a.Title,Me=je.a.Paragraph,Le=(je.a.Text,je.a.Link,function(e){Object(S.a)(n,e);var t=Object(P.a)(n);function n(e){var a;return Object(O.a)(this,n),(a=t.call(this,e)).state={},a}return Object(A.a)(n,[{key:"render",value:function(){var e=function(e){return a.createElement("span",{style:{color:"purple"}},a.createElement("strong",null,e))};return 1===this.props.mode_id?a.createElement("div",null,a.createElement(De,{level:3},"Summary statistics of data"),a.createElement(Me,null,a.createElement("strong",null,"Accuracy:")," The API accuracy varies across different years. In the accuracy chart, the x-axis encodes the year, and the y-axis encodes ",e("the API accuracy for this year.")," The color indicates different APIs. You can select multiple APIs to check the different APIs' performance in different years."),a.createElement(Me,null,a.createElement("strong",null,"Consistency:")," The API prediction results may vary across different years. In the consistency chart, each node represents one year of the prediction results of the API. The value on the edge between the nodes indicates ",e("the percentage of predictions remaining the same in those two years.")," The color of the edge indicates the consistency value, and the legend is shown at the bottom left of the chart. You can only select one API to check this chart."),a.createElement(Me,null,a.createElement("strong",null,"Confidence:")," The API confidence will also change across different years, even if the API in different years has the same prediction results. In the confidence chart, each node represents one year of the prediction results of the API. The value on the edge between the nodes indicates ",e("the average absolute confidence changes among all predictions in those two years.")," The color of the edge indicates the confidence change value, and the legend is shown at the bottom left of the chart. You can only select one API to check this chart."),a.createElement(Me,null,a.createElement("strong",null,"Fairness:")," The API may have different performances on the different subgroups of data (e.g., male and female). For such sensitive attributes, it is not desired that the API has different performance on them. In the fairness chart, the x-axis represents the sensitive attribute, and the y-axis represents ",e("the API accuracy on the subgroup specified by the attribute.")," The color of the bar indicates the year. You can select dataset COCO and only one API to check this chart.")):a.createElement("div",null,a.createElement(De,{level:3},"Explore data"),a.createElement(Me,null,a.createElement("strong",null,"Confidence Parallel Sets:")," Different instances will have different confidences for one API in different years. This chart uses each dimension to represent the individual year. Here, we consider a random subset of instances in the dataset to explore how confidence changes among those instances. In each dimension, there are several segments that represent different ranges of confidence. The length of the segment represents the percentage of instances in that range. The width of the ribbon plot between those dimensions represents the number of instances simultaneously satisfying the conditions in those years. ",e("You can click one segment or one ribbon plot to check the corresponding instances.")," Please select only one API to enable exploration."))}}]),n}(a.Component)),Ne=Object(c.b)((function(e){return{mode_id:e.mode_id}}),(function(e){return{}}))(Le),Te=(je.a.Title,je.a.Paragraph,je.a.Text,je.a.Link,function(e){Object(S.a)(n,e);var t=Object(P.a)(n);function n(e){var r;return Object(O.a)(this,n),(r=t.call(this,e)).InfoViewRef=void 0,r.ControlPanelRef=void 0,r.DescriptionRef=void 0,r.viewname_to_ref=void 0,r.onResizeStop=r.onResizeStop.bind(Object(I.a)(r)),r.getLayoutConfigWithName=r.getLayoutConfigWithName.bind(Object(I.a)(r)),r.getCurrentLayoutConfig=r.getCurrentLayoutConfig.bind(Object(I.a)(r)),r.getViewRefWithName=r.getViewRefWithName.bind(Object(I.a)(r)),r.InfoViewRef=a.createRef(),r.ControlPanelRef=a.createRef(),r.viewname_to_ref={Description:r.DescriptionRef,ControlPanel:r.ControlPanelRef,InfoView:r.InfoViewRef},r.state={layout_config:null,screenWidth:0,screenHeight:0,enableStatic:!0},r}return Object(A.a)(n,[{key:"componentDidMount",value:function(){this.setState({layout_config:this.getWholeLayoutConfig(),screenHeight:window.innerHeight,screenWidth:window.innerWidth})}},{key:"getViewRefWithName",value:function(e){if(Object.keys(this.viewname_to_ref).indexOf(e)>=0)return this.viewname_to_ref[e]}},{key:"getLayoutConfigWithName",value:function(e){var t=0,n=0,a=this.getViewRefWithName(e);return a&&(t=a.current.offsetWidth,n=a.current.offsetHeight),{width:t,height:n}}},{key:"getWholeLayoutConfig",value:function(){var e=this,t=Object.keys(this.viewname_to_ref),n={};return t.forEach((function(t){n[t]=e.getLayoutConfigWithName(t)})),n}},{key:"getCurrentLayoutConfig",value:function(e){var t=this.state.layout_config;return t&&t[e]?t[e]:null}},{key:"componentDidUpdate",value:function(e,t){e.dataset_id!==this.props.dataset_id&&(this.props.dataset_id&&this.props.dataset_id,this.setState({})),e.contentHeight===this.props.contentHeight&&e.contentWidth===this.props.contentWidth||this.setState({layout_config:this.getWholeLayoutConfig()})}},{key:"onLayoutChange",value:function(e){console.log("Layout",e)}},{key:"onResizeStop",value:function(e){console.log("onResizeStop",e),console.log("Layout",this.getWholeLayoutConfig()),this.setState({layout_config:this.getWholeLayoutConfig()})}},{key:"render",value:function(){var e=this,t=(this.props.dataset_id,function(e,t){return a.createElement(Pe,{width:e,height:t})}),n=function(t){e.setState({enableStatic:t})};document.addEventListener("keydown",(function(t){var a=e.state.enableStatic;switch(t.keyCode){case 9:return void(1==a&&(n(!1),alert("You have enabled the modified layout. You can press alt to disable it.")));case 18:return void(0==a&&(n(!0),alert("You have disabled the modified layout. You can press tab to modify it.")))}}));this.state.enableStatic;Math.floor(this.props.contentHeight/40);return function(){var n=e.props.contentWidth;return a.createElement("div",null,a.createElement("div",{className:"IntroViewBox",key:"c",ref:e.DescriptionRef},a.createElement(Ne,null)),a.createElement("div",{className:"IntroViewBox",key:"a",ref:e.ControlPanelRef},a.createElement(ve,{width:n,height:100})),a.createElement("div",{className:"IntroViewBox",key:"b",ref:e.InfoViewRef},t(n,350)))}()}}]),n}(a.Component)),Fe=Object(c.b)((function(e){return{dataset_id:e.dataset_id}}),(function(e){return{}}))(Te),Re=n(170),We=n.n(Re),He=(je.a.Title,je.a.Paragraph),ze=(je.a.Text,je.a.Link,function(e){Object(S.a)(n,e);var t=Object(P.a)(n);function n(e){var a;return Object(O.a)(this,n),(a=t.call(this,e)).state={},a}return Object(A.a)(n,[{key:"render",value:function(){var e={height:"120px"},t=e;return t=this.props.contentWidth>540?e:{width:"100%"},a.createElement("div",{className:"IntroViewBox"},a.createElement(je.a,null,a.createElement("div",{style:{textAlign:"center"}},a.createElement("img",{src:We.a,style:t,alt:"banner"})),a.createElement(He,null,"Commercial ML APIs offered by providers such as Google, Amazon and Microsoft have dramatically simplified ML adoption in many applications. Numerous companies and academics pay to use ML APIs for tasks such as object detection, OCR and sentiment analysis. Different ML APIs tackling the same task can have very heterogeneous performance. Moreover, the ML models underlying the APIs also evolve over time. As ML APIs rapidly become a valuable marketplace and a widespread way to consume machine learning, it is critical to systematically study and compare different APIs with each other and to characterize how APIs change over time. However, this topic is currently underexplored due to the lack of data. Here, we present HAPI (History of APIs), a longitudinal dataset of 1,761,417 instances of commercial ML API applications (involving APIs from Amazon, Google, IBM, Microsoft and other providers) across diverse tasks including image tagging, speech recognition and text mining from 2020 to 2022. Each instance consists of a query input for an API (e.g., an image or text) along with the API\u2019s output prediction/annotation and confidence scores. HAPI is the first large-scale dataset of ML API usages and is a unique resource for studying ML-as-a-service (MLaaS). As examples of the types of analyses that HAPI enables, we show that ML APIs\u2019 performance change substantially over time\u2014several APIs\u2019 accuracies dropped on specific benchmark datasets. Even when the API\u2019s aggregate performance stays steady, its error modes can shift across different subtypes of data between 2020 and 2022. Such changes can substantially impact the entire analytics pipelines that use some ML API as a component. We further use HAPI to study commercial APIs\u2019 performance disparities across demographic subgroups over time. HAPI can stimulate more research in the growing field of MLaaS.")))}}]),n}(a.Component)),Ve=n(171),Ge=n.n(Ve),Be=j.a.Content,Ye=j.a.Header;j.a.Sider;var Ue=function(e){Object(S.a)(n,e);var t=Object(P.a)(n);function n(e){var a;return Object(O.a)(this,n),(a=t.call(this,e)).ContentRef=void 0,a.ContentRef=r.a.createRef(),a.onResize=a.onResize.bind(Object(I.a)(a)),a.onMenuSelect=a.onMenuSelect.bind(Object(I.a)(a)),a.state={contentWidth:0,contentHeight:0,screenHeight:0,screenWidth:0,menu_selected_keys:["intro"]},a}return Object(A.a)(n,[{key:"getLayoutConfig",value:function(){var e=1500,t=710;return this.ContentRef&&(e=this.ContentRef.current.offsetWidth,t=this.ContentRef.current.offsetHeight),{contentWidth:e,contentHeight:t}}},{key:"onResize",value:function(){this.updateLayoutState()}},{key:"updateLayoutState",value:function(){var e=this.getLayoutConfig(),t=e.contentWidth,n=e.contentHeight;this.setState({contentWidth:t,contentHeight:n,screenHeight:window.innerHeight,screenWidth:window.innerWidth})}},{key:"componentDidMount",value:function(){window.addEventListener("resize",this.onResize),this.updateLayoutState()}},{key:"componentDidUpdate",value:function(e,t){}},{key:"onMenuSelect",value:function(e){console.log("Menu change",e.selectedKeys);var t=e.selectedKeys;if(t.length>=1){var n=t[0];if("download"==n)return void function(e,t){var n=document.createElement("a");n.setAttribute("href",t),n.setAttribute("download",e),document.body.appendChild(n),n.click(),document.body.removeChild(n)}("hapi.tar.gz","https://storage.googleapis.com/hapi-data/hapi.tar.gz");if(["docs","contact"].indexOf(n)>=0)return}if(this.setState({menu_selected_keys:e.selectedKeys}),t.length>=1){var a=t[0];"intro"===a?this.props.changeViewMode(1):"metrics"===a?(this.props.changeViewMode(2),this.props.changeMode(1)):"explore"===a&&(this.props.changeViewMode(3),this.props.changeMode(2))}}},{key:"render",value:function(){var e=this,t=this.state,n=t.screenWidth,a=(t.screenHeight,t.contentWidth),i=t.contentHeight;console.log("contentWidth, height",a,i);var o=function(){return[r.a.createElement(D.a.Item,{key:"intro",icon:r.a.createElement(N.a,null)},"About"),r.a.createElement(D.a.Item,{key:"metrics",icon:r.a.createElement(T.a,null)},"Examples Analysis"),r.a.createElement(D.a.Item,{key:"explore",icon:r.a.createElement(F.a,null)},"Explore"),r.a.createElement(D.a.Item,{key:"download",icon:r.a.createElement(R.a,null)},"Download")]},c=function(t,n){return r.a.createElement(D.a,{key:"menu_1",mode:t,className:n,selectedKeys:e.state.menu_selected_keys,theme:"dark",onSelect:e.onMenuSelect},o())},s=function(t,n){return r.a.createElement(D.a,{key:"menu_2",mode:t,className:n,selectedKeys:e.state.menu_selected_keys,theme:"dark",onSelect:e.onMenuSelect},r.a.createElement(D.a.SubMenu,{key:"SubMenu",title:"",icon:r.a.createElement(W.a,null)},o()))},l=!1,u=!1,d=!1,h=4,f=20,p=a,m="left",g=n-137-50-100;return g<50&&(g=50),n>=1100?(l=!1,u=!0,d=!0,h=0,f=24,p=a,m="left"):(l=!1,u=!0,d=!1,h=0,f=24,p=a,m="right",g=100),r.a.createElement(j.a,{className:"app"},r.a.createElement(Ye,{className:"appHeader"},r.a.createElement("div",{style:{float:"left"},className:"appTitle"},r.a.createElement("img",{src:Ge.a,style:{height:"25px"},alt:"banner"}),"\xa0\xa0\xa0\xa0\xa0"),r.a.createElement("div",{style:{float:m,width:g+"px"}},function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e?t?c("horizontal",""):s("horizontal",""):r.a.createElement("div",null)}(u,d))),r.a.createElement(Be,{className:"appContent"},r.a.createElement("div",{style:{height:"100%",width:"100%"},ref:this.ContentRef},r.a.createElement(M.a,{style:{height:"100%",width:"100%"}},r.a.createElement(L.a,{span:h},l?c("vertical","verticalmenu"):r.a.createElement("div",null)),r.a.createElement(L.a,{span:f,style:{height:"100%",width:"100%",overflow:"auto"}},a>0&&i>0?function(e,t){return 1===e?r.a.createElement(ze,{contentWidth:t,contentHeight:i}):r.a.createElement(Fe,{contentWidth:t,contentHeight:i})}(this.props.view_mode,p):r.a.createElement("div",null)))),r.a.createElement("div",{id:"tooltip_proj"}),r.a.createElement("div",{id:"tooltip_matrix"})))}}]),n}(r.a.Component),Je=Object(c.b)((function(e){return{mode_id:e.mode_id,view_mode:e.view_mode}}),(function(e){return{changeMode:function(t){return e(pe(t))},changeViewMode:function(t){return e(function(e){return{type:"VIEW_MODE_CHANGE",view_mode:e}}(t))}}}))(Ue),qe=Object(s.a)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"VIEW_MODE_CHANGE":return Object(l.a)(Object(l.a)({},e),{},{view_mode:t.view_mode});case"MODE_ID_CHANGE":return Object(l.a)(Object(l.a)({},e),{},{mode_id:t.mode_id});case"DATASET_ID_CHANGE":return Object(l.a)(Object(l.a)({},e),{},{dataset_id:t.dataset_id});case"API_ID_CHANGE":return Object(l.a)(Object(l.a)({},e),{},{api_id:t.api_id});case"API_ID_LIST_CHANGE":return Object(l.a)(Object(l.a)({},e),{},{api_id_list:t.api_id_list});case"TASK_ID_CHANGE":return Object(l.a)(Object(l.a)({},e),{},{task_id:t.task_id});case"INIT_DATASET_LIST":return Object(l.a)(Object(l.a)({},e),{},{datasetList:t.datasetList});case"INIT_DATA":return Object(l.a)(Object(l.a)({},e),{},{data:t.data});case"INIT_EXPLORE_META_DATA":return Object(l.a)(Object(l.a)({},e),{},{explore_meta_data:t.explore_meta_data});case"CLEAR_ID_INFO":return Object(l.a)(Object(l.a)({},e),{},{dataset_id:null,api_id:null,api_id_list:[]});default:return e}}));o.a.render(r.a.createElement(c.a,{store:qe},r.a.createElement(Je,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[184,1,2]]]);
//# sourceMappingURL=main.50a6e02a.chunk.js.map